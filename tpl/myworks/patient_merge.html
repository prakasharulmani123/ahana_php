<!-- main header -->
<div class="bg-light lter b-b wrapper-md">
    <div class="row">
        <div class="col-sm-6 col-xs-12">
            <h1 class="m-n font-thin h3 text-black">Patients Merge</h1>
        </div>
    </div>
</div>
<!-- / main header -->
<div class="wrapper-md ng-scope">
    <div ng-include="'tpl/blocks/alert.html'">
        {% include 'tpl/blocks/alert.html' %}
    </div>
    <div ng-controller="PatientMergeController" class="ng-scope">
        <div class="row">
            <div class="col-sm-6">
                <div class="panel panel-default">
                    <div class="panel-heading font-bold">Patient Search</div>
                    <div class="panel-body">
                        <form role="form">
                            <div class="form-group">
                                <input ng-model="patient" id="patient-search1" type="text" class="form-control patient_merge_input1" autocomplete="off">
                                <div class="patient-merge-result" id="patient-merge-result1" ng-if="patient != '' && patient_search_result">
                                    <ul class="merge-patientcont result-patient-merge1" id='patient-merge1'>
                                        <li ng-repeat="(key, patient) in patient_search_result| filter:filterFn" class="{{key == 0 ? 'selected' : ''}}">
                                            <div class="row"> 
                                                <div class="col-xs-12 col-sm-2 col-md-2"> 
                                                    <img ng-if="$even" alt="" ng-src="{{patient.Patient.patient_image ? patient.Patient.patient_image : 'img/man-icon.png'}}" class="patient-image">
                                                    <img ng-if="$odd" alt="" ng-src="{{patient.Patient.patient_image ? patient.Patient.patient_image : 'img/man-icon2.png'}}" class="patient-image">
                                                </div>
                                                <div class="col-xs-12 col-sm-5 col-md-6"> 
                                                    <div class="row ng-binding"> 
                                                        <a tooltip="{{patient.Patient.fullcurrentaddress|| patient.Patient.fullpermanentaddress}}" ng-bind-html="patient.Patient.fullname | highlight:patient" href="javascript:void(0)" ng-click="displayPatient(patient.Patient.patient_global_guid, 'patient')" class="ng-binding">
                                                        </a>
                                                        <b ng-if="patient.Patient.patient_age">({{patient.Patient.patient_age}}y) </b>
                                                        <br>
                                                        <span class="pull-left" ng-bind-html="patient.Patient.patient_global_int_code | highlight:patient"></span> &nbsp; &nbsp;
                                                        <span ng-bind-html="patient.Patient.patient_mobile | highlight:patient"> </span> 
                                                    </div>
                                                </div>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <div class="row" ng-if="selected_patients.length > 0">
            <div class="col-sm-12">
                <button ng-click="saveForm()" class="btn btn-sm btn-primary">
                    <i class="fa fa-users"></i> Merge Patients
                </button>
            </div>

            <div class="col-sm-4" ng-repeat="(selected_key, selected_patient) in  selected_patients ">
                <div class="panel panel-default">
                    <div class="panel-heading font-bold">
                        <label class="i-checks">
                            <input type="radio" name="a" ng-value="true" ng-model="selected_patient.is_primary" ng-change="choosePrimary(selected_key)">
                            <i></i> Primary
                        </label>
                        <button ng-click="removeMergePatient($index)" class="btn btn-xs btn-danger pull-right">
                            <i class="fa fa-remove"></i>
                        </button>
                    </div>
                    <div class="panel-body">
                        <form role="form" class="form-horizontal form-validation">
                            <div class="form-group">
                                <label class="col-sm-4 control-label">Patient Name</label>
                                <div class="col-sm-8">{{selected_patient.Patient.fullname}}</div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>